#!/usr/bin/env bash

export PROJECT_ROOT
PROJECT_ROOT="$( cd "$(dirname "$0")/../../" >/dev/null 2>&1 ; pwd -P )"

if [[ -n ${1} && ${1} == '-b' ]]; then
    bin/docker/docker-compose build --no-cache
fi
bin/docker/docker-compose up -d

# Start required DBs
if [ -f "${PROJECT_ROOT}/.env.mysql" ]; then
    bin/docker/start-db mysql
fi

if [ -f "${PROJECT_ROOT}/.env.postgres" ]; then
    bin/docker/start-db postgres
fi

bin/docker/cron setup