#!/bin/sh

if [ -z "$(docker ps -q)" ]; then
    echo "You have no running container"
else
    echo "Stopping all running containers..."

    if [ -z "${PROJECT_ROOT}" ]; then
        export PROJECT_ROOT="$(dirname "$(realpath $0)")/../.."
    fi

    if [ -f "${PROJECT_ROOT}/.env.mysql" ]; then
        "${PROJECT_ROOT}"/bin/docker/stop-db -m
    fi

    if [ -f "${PROJECT_ROOT}/.env.mariadb" ]; then
        "${PROJECT_ROOT}"/bin/docker/stop-db --mariadb
    fi

    if [ -f "${PROJECT_ROOT}/.env.pgsql" ]; then
        "${PROJECT_ROOT}"/bin/docker/stop-db -p
    fi

    "${PROJECT_ROOT}"/bin/docker/stop

    if [ "$(docker network ls | grep veildb-network)" ]; then
        docker network rm veildb-network
    fi
fi